{% extends 'base.html' %}

{% load static %}

{% block content %}   

    <div class="review-detail-container">
        <h1>{{ review.title }}</h1>
        <p class="author"><strong>Author:</strong> {{ review.author }}</p>
        <p class="date"><small>Posted on: {{ review.created_on|date:"F j, Y" }}</small></p>
        <p><strong>Rating:</strong>
            <span class="star-rating">
                {% for i in "12345"|slice:":post.rating"|make_list %}
                    ‚òÖ 
                {% endfor %}
            </span>
        </p>
        
        <div class="like-container">
            {% if user.is_authenticated %}
                <form method="POST" class="like-form">
                    {% csrf_token %}
                    <button type="submit" name="like" class="like-button">
                        {% if user_liked %}
                            ‚ù§Ô∏è
                        {% else %}
                            ü§ç
                        {% endif %}
                    </button>
                    <span class="like-count">{{ total_likes }}</span>
                </form>
            {% else %}
                <span class="like-button">‚ù§Ô∏è</span>
                <span class="like-count">{{ total_likes }}</span>
            {% endif %}
        </div>



        <div class="review-body">
            <p>{{ review.content }}</p>
        </div>

        <!-- Comment Form -->
        <div class="comment-section">
            <h3>Comments</h3>
            <form method="POST">
                {% csrf_token %}
                {{ form.body }}
                <button type="submit" class="btn">Add Comment</button>
            </form>
            <div class="comments-list">
                {% for comment in comments %}
                    <p><strong>{{ comment.author.username }}</strong> says: {{ comment.body }}</p>
                    <p><small>Posted on: {{ comment.created_on|date:"F j, Y" }}</small></p>
                    <hr>
                {% empty %}
                    <p>No comments yet.</p>
                {% endfor %}
            </div>
        </div>

        {% if user.is_authenticated %}
            <div class="edit-delete-buttons">
                <a href="{% url 'edit_review' review.id %}" class="btn">Edit</a>
                <a href="{% url 'delete_review' review.id %}" class="btn">Delete</a>
            </div>
        {% endif %}
    </div>
{% endblock %}
    <footer>
        <p>&copy; 2025 Space Shack</p>
    </footer>

</body>
</html>
